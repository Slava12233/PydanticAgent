"""
תבניות פרומפטים לפי סוגי משימות
"""

# מילות מפתח לזיהוי סוגי משימות
TASK_KEYWORDS = {
    "product_management": [
        "מוצר", "מוצרים", "פריט", "פריטים", "קטלוג",
        "הוסף", "הוספת", "עדכן", "עדכון", "מחק", "מחיקת",
        "מחיר", "מחירים", "מלאי", "כמות", "תמונה", "תמונות"
    ],
    "order_management": [
        "הזמנה", "הזמנות", "משלוח", "משלוחים", "תשלום",
        "סטטוס", "מצב", "ביטול", "החזר", "זיכוי",
        "לקוח", "לקוחות", "כתובת", "פרטים"
    ],
    "customer_management": [
        "לקוח", "לקוחות", "משתמש", "משתמשים", "פרופיל",
        "רשימה", "חיפוש", "עדכון", "מחיקה", "פרטים",
        "כתובת", "טלפון", "אימייל", "דואר"
    ],
    "inventory_management": [
        "מלאי", "כמות", "מחסן", "אחסון", "ספירה",
        "עדכון", "הוספה", "הורדה", "התראה", "מינימום",
        "מקסימום", "זמין", "חסר", "הזמנה"
    ],
    "sales_analysis": [
        "מכירות", "הכנסות", "רווח", "הפסד", "דוח",
        "סטטיסטיקה", "נתונים", "גרף", "תרשים", "מגמה",
        "השוואה", "ניתוח", "תקופה", "ביצועים"
    ],
    "seo_optimization": [
        "קידום", "אופטימיזציה", "seo", "מנועי חיפוש",
        "מילות מפתח", "תיאור", "כותרת", "תגיות",
        "דירוג", "חיפוש", "גוגל", "אינדוקס"
    ],
    "pricing_strategy": [
        "מחיר", "מחירים", "הנחה", "הנחות", "מבצע",
        "מבצעים", "תמחור", "עלות", "רווח", "מרווח",
        "תחרות", "שוק", "השוואה"
    ],
    "marketing": [
        "שיווק", "פרסום", "קמפיין", "מודעה", "מודעות",
        "קידום", "מכירות", "לקוחות", "קהל", "יעד",
        "מדיה", "חברתית", "אימייל", "ניוזלטר"
    ],
    "document_management": [
        "מסמך", "מסמכים", "קובץ", "קבצים", "תיעוד",
        "הוראות", "מדריך", "מדריכים", "עזרה", "תיק",
        "ספריה", "תיקיה", "ארכיון"
    ]
}

# פרומפטים ספציפיים למשימות
TASK_PROMPTS = {
    "product_management": """
    אתה עוזר בניהול מוצרים בחנות מקוונת.
    אתה יכול לעזור ב:
    - הוספת מוצרים חדשים
    - עדכון פרטי מוצרים קיימים
    - מחיקת מוצרים
    - ניהול מלאי
    - ניהול קטגוריות ותגיות
    - טיפול בתמונות מוצרים
    - הגדרת מחירים ומבצעים
    """,
    
    "order_management": """
    אתה עוזר בניהול הזמנות בחנות מקוונת.
    אתה יכול לעזור ב:
    - צפייה בפרטי הזמנות
    - עדכון סטטוס הזמנות
    - טיפול בביטולים והחזרים
    - מעקב אחר משלוחים
    - טיפול בבעיות תשלום
    - יצירת דוחות הזמנות
    """,
    
    "customer_management": """
    אתה עוזר בניהול לקוחות.
    אתה יכול לעזור ב:
    - צפייה בפרטי לקוחות
    - עדכון פרטי לקוחות
    - חיפוש לקוחות
    - ניהול קבוצות לקוחות
    - טיפול בפניות לקוחות
    - מעקב אחר היסטוריית לקוחות
    """,
    
    "inventory_management": """
    אתה עוזר בניהול מלאי.
    אתה יכול לעזור ב:
    - מעקב אחר כמויות מלאי
    - עדכון מלאי
    - התראות מלאי נמוך
    - ניהול מחסן
    - ספירות מלאי
    - דוחות מלאי
    """,
    
    "sales_analysis": """
    אתה עוזר בניתוח מכירות.
    אתה יכול לעזור ב:
    - ניתוח נתוני מכירות
    - זיהוי מגמות
    - השוואת תקופות
    - דוחות ביצועים
    - תחזיות מכירות
    - המלצות לשיפור
    """,
    
    "seo_optimization": """
    אתה עוזר באופטימיזציה למנועי חיפוש.
    אתה יכול לעזור ב:
    - מחקר מילות מפתח
    - כתיבת תיאורים ממוטבים
    - שיפור כותרות ותגיות
    - מעקב אחר דירוגים
    - המלצות לשיפור SEO
    - ניתוח תחרות
    """,
    
    "pricing_strategy": """
    אתה עוזר בניהול מחירים.
    אתה יכול לעזור ב:
    - קביעת מחירים
    - ניהול הנחות ומבצעים
    - ניתוח תחרות
    - חישוב מרווחי רווח
    - אסטרטגיות תמחור
    - מבצעים מיוחדים
    """,
    
    "marketing": """
    אתה עוזר בשיווק ופרסום.
    אתה יכול לעזור ב:
    - תכנון קמפיינים
    - כתיבת תוכן שיווקי
    - ניהול מדיה חברתית
    - קמפיינים בדוא"ל
    - ניתוח ביצועי שיווק
    - המלצות לשיפור
    """
}

def identify_task_type(message: str) -> str:
    """
    זיהוי סוג המשימה לפי תוכן ההודעה
    
    Args:
        message: הודעת המשתמש
        
    Returns:
        סוג המשימה
    """
    message = message.lower()
    max_score = 0
    task_type = "general"
    
    # חיפוש מילות מפתח בהודעה
    for task, keywords in TASK_KEYWORDS.items():
        score = sum(1 for keyword in keywords if keyword in message)
        if score > max_score:
            max_score = score
            task_type = task
    
    return task_type

def get_task_prompt(task_type: str) -> str:
    """
    קבלת פרומפט ספציפי למשימה
    
    Args:
        task_type: סוג המשימה
        
    Returns:
        פרומפט ספציפי למשימה
    """
    return TASK_PROMPTS.get(task_type, "") 